<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>MD 2025 — Wellington points</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  html,body {
    height:100%;
    margin:0;
    background:#111; /* dark background */
  }
  header, footer {
    background:#111;
    color:#eee;
    font-family:system-ui;
  }
  #map {
    height:calc(100% - 70px);
    width:100%;
    background:#000; /* plain dark background for map area */
  }
  .leaflet-popup-content-wrapper{background:#222;color:#fff}
  .leaflet-control-layers { display: none !important; }
</style>
</head>
<body>
<header><strong>Mission Day 2025 — Wellington</strong></header>
<div id="map" role="region" aria-label="Map of portals"></div>
<footer id="status">Loaded 34 points</footer>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  // Inline GeoJSON data
  const data = {"type":"FeatureCollection","features":[{"type":"Feature","properties":{"title":"St. John's Church"},"geometry":{"type":"Point","coordinates":[174.773456,-41.290865]}},{"type":"Feature","properties":{"title":"Capital Market mural"},"geometry":{"type":"Point","coordinates":[174.774213,-41.290423]}},{"type":"Feature","properties":{"title":"NZ Olympic Committee"},"geometry":{"type":"Point","coordinates":[174.774014,-41.289859]}},{"type":"Feature","properties":{"title":"Tiger shark"},"geometry":{"type":"Point","coordinates":[174.774378,-41.289842]}},{"type":"Feature","properties":{"title":"Five Eyed Cat Mural"},"geometry":{"type":"Point","coordinates":[174.774634,-41.289865]}},{"type":"Feature","properties":{"title":"Hotel St. George"},"geometry":{"type":"Point","coordinates":[174.774592,-41.28919]}},{"type":"Feature","properties":{"title":"Scout Unicorn"},"geometry":{"type":"Point","coordinates":[174.777595,-41.293158]}},{"type":"Feature","properties":{"title":"Evil Empire"},"geometry":{"type":"Point","coordinates":[174.77763,-41.29295]}},{"type":"Feature","properties":{"title":"Egmont Street Living Wall"},"geometry":{"type":"Point","coordinates":[174.777837,-41.292501]}},{"type":"Feature","properties":{"title":"Maud Basham (Aunt Daisy)"},"geometry":{"type":"Point","coordinates":[174.778267,-41.292347]}},{"type":"Feature","properties":{"title":"Te Aro Park, Memorial Cairn"},"geometry":{"type":"Point","coordinates":[174.778554,-41.292309]}},{"type":"Feature","properties":{"title":"Splash Mural"},"geometry":{"type":"Point","coordinates":[174.778293,-41.292734]}},{"type":"Feature","properties":{"title":"GT3"},"geometry":{"type":"Point","coordinates":[174.779391,-41.294875]}},{"type":"Feature","properties":{"title":"Ford Motor Company Workshop No.1 - 1925"},"geometry":{"type":"Point","coordinates":[174.779697,-41.295086]}},{"type":"Feature","properties":{"title":"Hand-pulled Noodles"},"geometry":{"type":"Point","coordinates":[174.780183,-41.29497]}},{"type":"Feature","properties":{"title":"Lorne St 1910s Photograph Prints"},"geometry":{"type":"Point","coordinates":[174.780657,-41.29553]}},{"type":"Feature","properties":{"title":"Mystic Kitchen Floral Mural"},"geometry":{"type":"Point","coordinates":[174.779861,-41.295612]}},{"type":"Feature","properties":{"title":"Haunted House on Cuba St"},"geometry":{"type":"Point","coordinates":[174.775894,-41.292839]}},{"type":"Feature","properties":{"title":"Skateboard Dog"},"geometry":{"type":"Point","coordinates":[174.775558,-41.292552]}},{"type":"Feature","properties":{"title":"inkLink Pandas"},"geometry":{"type":"Point","coordinates":[174.77595,-41.292624]}},{"type":"Feature","properties":{"title":"Wellington Workingmens' Plaque"},"geometry":{"type":"Point","coordinates":[174.776212,-41.292559]}},{"type":"Feature","properties":{"title":"Green Tuatara"},"geometry":{"type":"Point","coordinates":[174.776275,-41.292335]}},{"type":"Feature","properties":{"title":"Bucket Fountain"},"geometry":{"type":"Point","coordinates":[174.776324,-41.292221]}},{"type":"Feature","properties":{"title":"Lukes Lane Street Art"},"geometry":{"type":"Point","coordinates":[174.778192,-41.291935]}},{"type":"Feature","properties":{"title":"Te Aro Park Sign"},"geometry":{"type":"Point","coordinates":[174.777945,-41.291963]}},{"type":"Feature","properties":{"title":"Opera House"},"geometry":{"type":"Point","coordinates":[174.777723,-41.291632]}},{"type":"Feature","properties":{"title":"Opera House Lane Murals"},"geometry":{"type":"Point","coordinates":[174.777859,-41.291346]}},{"type":"Feature","properties":{"title":"TARDIS Elevator"},"geometry":{"type":"Point","coordinates":[174.777222,-41.291239]}},{"type":"Feature","properties":{"title":"Cuban Monster in Wellington"},"geometry":{"type":"Point","coordinates":[174.776854,-41.291263]}},{"type":"Feature","properties":{"title":"Wellington Gas Company Building (Former)"},"geometry":{"type":"Point","coordinates":[174.78091,-41.293236]}},{"type":"Feature","properties":{"title":"1924 Historic Building"},"geometry":{"type":"Point","coordinates":[174.781541,-41.292961]}},{"type":"Feature","properties":{"title":"Tory Street Clock"},"geometry":{"type":"Point","coordinates":[174.781303,-41.293373]}},{"type":"Feature","properties":{"title":"Monster Motel Mural"},"geometry":{"type":"Point","coordinates":[174.781332,-41.293985]}},{"type":"Feature","properties":{"title":"Paramount Cinemas"},"geometry":{"type":"Point","coordinates":[174.782146,-41.293848]}}]};

  const map = L.map('map').setView([-41.2924,174.7787], 14);

  // CartoDB Dark Matter tiles (dark basemap)
  L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
    maxZoom: 20,
    attribution: '&copy; OpenStreetMap contributors &copy; CARTO'
  }).addTo(map);

  // style for markers
  function pointToLayer(feature, latlng) {
    return L.circleMarker(latlng, { radius: 5, weight:1, color:'#fff', fillColor:'#fff', fillOpacity:0.9 });
  }

  function onEachFeature(feature, layer) {
    const title = (feature.properties && feature.properties.title) || 'Portal';
    layer.bindPopup('<strong>' + escapeHtml(title) + '</strong>');
  }

  const gj = L.geoJSON(data, { pointToLayer, onEachFeature }).addTo(map);

  // Add Mimosa points as a toggleable overlay
  const mimosa = {"type":"FeatureCollection","features":[{"type":"Feature","properties":{"title":"Joe's Garage","color":"#E40303","isPrimary":true},"geometry":{"type":"Point","coordinates":[174.78185449670508,-41.292189690157905]}},{"type":"Feature","properties":{"title":"Loretta","color":"#E40303","isPrimary":false},"geometry":{"type":"Point","coordinates":[174.77530972689672,-41.294044148279774]}},{"type":"Feature","properties":{"title":"Nolita","color":"#FF8C00","isPrimary":true},"geometry":{"type":"Point","coordinates":[174.77490203596696,-41.29488254887213]}},{"type":"Feature","properties":{"title":"Southern Cross","color":"#FF8C00","isPrimary":false},"geometry":{"type":"Point","coordinates":[174.77447289274116,-41.296317501677066]}},{"type":"Feature","properties":{"title":"The Arborist","color":"#FFED00","isPrimary":true},"geometry":{"type":"Point","coordinates":[174.77372169915301,-41.290497143373244]}},{"type":"Feature","properties":{"title":"Floriditas","color":"#FFED00","isPrimary":false},"geometry":{"type":"Point","coordinates":[174.7755886722603,-41.29357657759339]}},{"type":"Feature","properties":{"title":"Bin 44","color":"#008026","isPrimary":true},"geometry":{"type":"Point","coordinates":[174.77891393424025,-41.284354147668736]}},{"type":"Feature","properties":{"title":"Thunderbird","color":"#008026","isPrimary":false},"geometry":{"type":"Point","coordinates":[174.77676828569977,-41.28345136146265]}},{"type":"Feature","properties":{"title":"Chouchou","color":"#004DFF","isPrimary":true},"geometry":{"type":"Point","coordinates":[174.7804594031484,-41.289868093231775]}},{"type":"Feature","properties":{"title":"Dockside","color":"#750787","isPrimary":true},"geometry":{"type":"Point","coordinates":[174.779450328553,-41.28428962288169]}},{"type":"Feature","properties":{"title":"St John's Bar","color":"#750787","isPrimary":false},"geometry":{"type":"Point","coordinates":[174.77919335626228,-41.28949734603456]}}]};
  
  // Build the layer but don't add yet
  const mimosaLayer = L.geoJSON(mimosa, {
    pointToLayer: (feature, latlng) =>
      L.circleMarker(latlng, {
        radius: feature.properties.isPrimary ? 8 : 5,
        weight: 2,
        color: feature.properties.color,
        fillColor: feature.properties.color,
        fillOpacity: 1
      }),
    onEachFeature: (feature, layer) => {
      layer.bindPopup('<strong>' + feature.properties.title + '</strong>');
    }
  });
  
  // Helper to read truthy URL params
  function truthy(v) {
    if (!v) return false;
    return ['1','true','on','yes','y'].includes(String(v).toLowerCase());
  }
  
  // If URL has ?mimosa=on/true/1/yes/y, show initially
  const qs = new URLSearchParams(location.search);
  const showMimosa = truthy(qs.get('mimosa'));
  if (showMimosa) mimosaLayer.addTo(map);
  
  // Layers control hidden — Mimosa toggled only via URL
  // L.control.layers(null, { 'Mimosa locations': mimosaLayer }, { collapsed: false }).addTo(map);
  
  // fit to bounds
  try {
    map.fitBounds(gj.getBounds().pad(0.1));
  } catch (e) {
    // ignore
  }

  // simple escape for popup
  function escapeHtml(s) {
    return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }
</script>
</body>
</html>
